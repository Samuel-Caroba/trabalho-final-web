<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Servi√ßos - Caroba Contabilidade</title>
  <link rel="stylesheet" href="/css/style.css" />
</head>
<body>
  <!-- Cabe√ßalho -->
  <header>
    <div class="logo">
      <img src="/images/image.png" alt="Caroba Contabilidade" />
    </div>
    <nav>
      <ul>
        <li><a href="/index.html">In√≠cio</a></li>
        <li><a href="/servico.html">Servi√ßos</a></li>
      </ul>
    </nav>
  </header>

  <!-- Conte√∫do Principal -->
  <main>
    <div class="servicos-box">
      <h2>Escolha um servi√ßo</h2>
      <select id="servicoSelect">
        <option value="">-- Selecione --</option>
      </select>
    </div>

    <div class="info-box" id="infoBox">
      <h2>Informa√ß√µes</h2>
      <p>Selecione um servi√ßo para ver os detalhes.</p>
      <!-- Os blocos dos servi√ßos ser√£o inseridos aqui dinamicamente -->
    </div>
  </main>

  <!-- Rodap√© -->
  <footer>
    <p>üìå Contato: Instagram | WhatsApp | Endere√ßo</p>
  </footer>

  <script>
    const select = document.getElementById("servicoSelect");
    const infoBox = document.getElementById("infoBox");

    async function carregarServicos() {
      try {
        const resposta = await fetch("https://back-end-tf-web-gamma.vercel.app/servico");
        if (!resposta.ok) throw new Error("Falha ao buscar servi√ßos");
        const servicos = await resposta.json();

        // Limpa o select e adiciona op√ß√µes
        select.innerHTML = '<option value="">-- Selecione --</option>';
        servicos.forEach(s => {
          const option = document.createElement("option");
          option.value = s.id_servico; // Usa o ID como valor
          option.textContent = s.nome;
          select.appendChild(option);
        });

        // Cria os blocos de informa√ß√£o (escondidos por padr√£o)
        infoBox.innerHTML = `
          <h2>Informa√ß√µes</h2>
          <p>Selecione um servi√ßo para ver os detalhes.</p>
        `;
        servicos.forEach(s => {
          const div = document.createElement("div");
          div.id = `servico-${s.id_servico}`; // ID √∫nico
          div.className = "servico";
          div.style.display = "none"; // Esconde por padr√£o
          div.innerHTML = `
            <h3>${s.nome}</h3>
            <p>${s.descricao || "Descri√ß√£o n√£o informada."}</p>
            <p class="valor">Valor: R$ ${parseFloat(s.valor).toFixed(2)}</p>
          `;
          infoBox.appendChild(div);
        });

      } catch (erro) {
        console.error(erro);
        infoBox.innerHTML = "<h2>Erro</h2><p>N√£o foi poss√≠vel carregar os servi√ßos. Tente novamente mais tarde.</p>";
      }
    }

    // Mostra o servi√ßo selecionado
    select.addEventListener("change", function () {
      const todosServicos = document.querySelectorAll(".servico");
      todosServicos.forEach(s => s.style.display = "none");

      const idSelecionado = this.value;
      if (idSelecionado) {
        const servicoDiv = document.getElementById(`servico-${idSelecionado}`);
        if (servicoDiv) servicoDiv.style.display = "block";
      }
    });

    // Carrega ao abrir a p√°gina
    carregarServicos();
  </script>
</body>
</html>